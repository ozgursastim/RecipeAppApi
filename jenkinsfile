pipeline{
    agent {docker {image 'python:3.8.3'}}
    stage {
        stage('build'){
            steps {
                sh 'pip install -r requirements.txt'
            }
        }
    }
    stage('test'){
        steps {
            sh 'docker-compose run app sh -c "python manage.py test && flake8"'
        }
    }
}